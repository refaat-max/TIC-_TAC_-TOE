name: C++ CI/CD with Qt

on: [push, pull_request]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Install Qt and g++
      run: |
        sudo apt-get update
        sudo apt-get install -y qtbase5-dev g++

    - name: Build the main app
      run: |
        mkdir build
        g++ -fPIC -I. -I/usr/include/qt -I/usr/include/qt/QtWidgets \
        -o build/AdvancedTicTacToe \
        main.cpp gamelogic.cpp gamewindow.cpp mainwindow.cpp userauth.cpp \
        -lQt5Widgets -lQt5Gui -lQt5Core

    - name: Build and run tests
      run: |
        g++ -o build/test_gamelogic test_gamelogic.cpp gamelogic.cpp
        ./build/test_gamelogic

    - name: Ignore Executable folder
      run: echo "Executable/ folder exists only for local .exe version. Skipping..."

    - name: "CI Result: Passed"
      if: success()
      run: echo "✅ All tests passed."

    - name: "CI Result: Failed"
      if: failure()
      run: echo "❌ One or more tests failed."

